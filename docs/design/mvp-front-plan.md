# MVP 前端工作计划（v0.1 草案）

面向 Nickel-System 的前端从设计到实现的高层计划，用于指导 MVP 阶段的落地与协作。该文档会随着需求澄清与实现推进迭代更新。

## 阶段与产出（里程碑）
1) 目标与核心流程
- 明确用户角色、首要用例（前三个闭环）、成功指标、设备范围。
- 产出：目标陈述、核心用例列表、成功指标草案。

2) API 契约梳理
- 盘点后端接口、数据模型、鉴权机制、错误约定（码值→提示）。
- 产出：接口清单（路径/方法/参数/返回/示例）、实体模型定义。

3) 信息架构与线框
- 站点地图、导航结构、端到端用户流程线框（低保真）。
- 产出：Sitemap、关键页面线框（列表/详情/表单/仪表盘）。

4) 设计系统与样式
- 设计令牌：色彩/字号/间距/圆角/阴影、语义色、暗色可选。
- 产出：Token 表、组件规范（按钮/表单/表格/弹窗/通知等）。

5) 技术栈与脚手架
- 选择框架、UI 库、状态管理与数据层、代码规范、CI/CD。
- 产出：初始化仓库、基础依赖、项目结构、脚本、CI 配置。

6) 组件与状态规划
- 组件分层、路由与守卫、服务端状态与缓存策略、本地状态。
- 产出：组件清单、路由表、数据访问封装规范、错误/加载/空状态方案。

7) MVP 页面实现与联调
- 优先完成核心闭环（登录→核心任务→结果/反馈），对齐接口。
- 产出：可运行的核心页面、与后端打通的关键交互。

8) 质量保障
- 响应式适配、可访问性、性能预算、异常路径覆盖。
- 产出：适配断点规则、a11y 清单、性能基线报告、测试用例（必要）。

9) 发布与文档
- 环境配置、部署方案、使用说明、监控与告警接入（最小集）。
- 产出：部署脚本/说明、环境变量清单、运行手册、故障应对指引。

## 1 ：目标与核心流程
目标用户已定位为券商及期货专业人员，展示终端锁定浏览器大屏；成功指标暂不设硬性指标，将在落地过程中结合反馈再评估。核心业务闭环会在阶段 3 线框设计时同步沉淀。

## 2：API 契约梳理

**基础信息**
- 基础地址：`http://127.0.0.1:8000`（开发期），前端需通过 `.env` 可配置。
- 鉴权：当前无登录/权限控制；所有接口匿名可访问。
- 通用响应：`{ data, meta, error }`，其中 `error` 为字符串或 `null`。
- 错误处理：数据不存在时返回 `404 + {"detail": "..."}`；参数非法由 FastAPI 自动返回 `422`。
- CORS：已允许 `http://localhost:5173`、`http://127.0.0.1:5173`。

**数据模型**
- `IntradaySnapshot`：即时报价快照，核心字段（必填）`exchange`、`contract`、`captured_at`，其余数值字段均可为空。
- `DailyRecord`：日线数据，核心字段（必填）`exchange`、`contract`、`trade_date`。
- 标签字典：`meta.labels` 提供字段→中文列名映射。

**接口清单**

- `GET /health`
  - 功能：返回服务状态，含最近一次 LME 抓取时间、采集间隔、数据保留时长。
  - 用途：前端健康检查、轮询间隔（`intraday_interval_seconds`）。
- `GET /api/v1/dashboard/latest`
  - 参数：`exchange`（默认 `lme`）。
  - 返回：单条 `IntradaySnapshot`；若无数据返回 404。
- `GET /api/v1/dashboard/intraday`
  - 参数：`exchange`（默认 `lme`）、`limit`（1–500，默认 30）。
  - 返回：`IntradaySnapshot[]`，按最新→最旧排序；`meta.count` 表示返回条数。
- `GET /api/v1/dashboard/daily`
  - 参数：`exchange`（默认 `lme`）、`start_date`、`end_date`（`YYYY-MM-DD`，可为空）。
  - 返回：`DailyRecord[]`，按日期逆序；`meta` 附带筛选条件。

**字段说明（节选）**（完整定义参见 `backend/src/api/models.py`）
- `latest_price/open/high/low/close/settlement`：浮点数，若缺失返回 `null`。
- `change`：涨跌额；`change_pct`：涨跌幅百分比（原始值即百分数）。
- `elapsed_seconds`：从采集开始到当前条目的耗时（秒）。
- `tick_time`（Intraday）：原始行情时间戳字符串。

- 分页：`intraday` 通过 `limit` 控制，`daily` 当前无分页；已决定 MVP 先展示最近 N 条并在前端提供轻量列表视图（表格与图表结合），后续再评估是否需要后端分页或虚拟滚动。

**补充：**

- 交易所枚举：当前确认 MVP 仅覆盖 `lme` / `shfe`，后续如扩展需同步更新接口与前端枚举。
- 日期格式：FastAPI 接受字符串，前端需按 ISO（yyyy-mm-dd）传参。
- SSE：后端暂无推送接口，MVP 采用基于 `/health.intraday_interval_seconds` 的轮询刷新；视后续需求再升级为 SSE。

## 3 : 设计风格需求

### 整体风格
- **风格定位**：专业金融数据大屏，科技感与稳重感并存
- **设计语言**：现代扁平化设计，减少装饰元素，突出数据本身
- **视觉层次**：清晰的信息层级，重要数据突出显示，次要信息适当弱化
- **氛围营造**：深夜色背景配合高对比度数据展示，营造专业的交易氛围

### 色彩系统
#### 主色调
- **背景色**：深蓝色系 `#0F1729` (RGB(15, 23, 41))，营造沉稳专业的氛围
- **卡片背景**：半透明黑色 `rgba(0, 0, 0, 0.3-0.5)`，增加层次感
- **分割线**：`rgba(255, 255, 255, 0.1)`，用于区分内容区域

#### 文字色
- **主标题**：青白色 `#CCFFFF` (RGB(204, 255, 255))，突出但不刺眼
- **普通文字**：`#FFFFFF` 或 `rgba(255, 255, 255, 0.8-0.9)`
- **辅助文字**：`rgba(255, 255, 255, 0.6-0.7)`
- **数值文字**：纯白色 `#FFFFFF`，保证可读性

#### 语义色
- **涨色（红）**：`#FF4444` 或 `#FF6B6B`，用于表示上涨
- **跌色（绿）**：`#44FF44` 或 `#4ECDC4`，用于表示下跌
- **信息色**：`#1890FF`，用于提示信息
- **警告色**：`#FAAD14`，用于警告提示
- **成功色**：`#52C41A`，用于成功状态

### 字体与排版
#### 字体族
- **主字体**：系统字体栈 `-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif`
- **数字字体**：可选择使用等宽字体如 `'SF Mono', Monaco, Inconsolata, 'Roboto Mono'`，确保数字对齐

#### 字号层级
- **大标题**：32-36px，用于页面主标题
- **区块标题**：20-24px，用于各功能区块标题
- **数据数值**：24-28px，用于重要数据展示
- **正文**：14-16px，用于一般性文字说明
- **辅助文字**：12-13px，用于时间戳、单位等次要信息

#### 字重
- **标题**：500-600（中等偏粗）
- **数值**：600-700（较粗，突出数据）
- **正文**：400（常规）

### 信息架构
#### 布局结构
- **顶部标题区**：固定高度，显示系统名称、交易所信息、合约代码
- **左侧指标区**：25-30%宽度，垂直排列关键指标卡片
- **中央图表区**：40-50%宽度，展示K线图、走势图等主要图表
- **右侧数据区**：20-25%宽度，展示买卖盘口、实时成交等
- **底部状态栏**：固定高度，显示更新时间、系统状态

#### 卡片设计
- **圆角**：4-8px，适度圆角增加现代感
- **内边距**：16-20px，保证内容不拥挤
- **阴影**：轻微外阴影 `box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3)`
- **边框**：1px实线 `rgba(255, 255, 255, 0.1)` 或无边框

### 关键组件设计

#### 数据卡片
- **布局**：标题在上，数值在下，垂直排列
- **标题样式**：14px，辅助色，靠左对齐
- **数值样式**：24-28px，白色，粗体，靠左对齐
- **涨跌指示**：数值旁显示箭头图标和百分比，颜色随涨跌变化

#### 图表容器
- **背景**：半透明深色背景
- **坐标轴**：浅色线条，文字颜色 `rgba(255, 255, 255, 0.6)`
- **网格线**：虚线，透明度更低 `rgba(255, 255, 255, 0.1)`
- **图表颜色**：主数据线使用亮色如 `#00D4FF`，成交量使用半透明填充

#### 数据表格
- **表头**：深色背景，白色文字，12px字号
- **表行**：斑马纹设计，奇数行背景稍深
- **边框**：水平分割线，无垂直边框
- **对齐**：数值右对齐，文字左对齐
- **高亮**：最新行或重要数据可轻微高亮

#### 买卖盘口
- **分列布局**：左侧卖盘，右侧买盘，中间当前价突出
- **价格列**：等宽字体，保证对齐
- **数量列**：右侧对齐，可用进度条可视化大小
- **当前价**：不同背景色突出，字号更大

### 交互细节
#### 动画效果
- **数据更新**：数值变化时0.3s渐变，避免闪烁
- **图表切换**：0.5s淡入淡出
- **悬停效果**：卡片/按钮悬停时背景轻微变亮，0.2s过渡
- **加载动画**：使用骨架屏或脉冲动画，避免传统loading图标

#### 响应式设计
- **大屏（>1920px）**：充分利用空间，适当放大字号和间距
- **标准屏（1440px）**：基准设计尺寸，最佳显示效果
- **小屏（<1280px）**：调整布局为单列，隐藏次要信息
- **移动端**：重新设计为可滚动的卡片式布局

#### 状态反馈
- **实时状态**：页面顶部显示数据更新时间和连接状态
- **错误提示**：使用toast通知，自动消失
- **无数据**：显示友好的占位图和提示文字
- **加载中**：使用脉冲动画或骨架屏

### 特殊效果
#### 背景效果
- **渐变背景**：可考虑使用微妙的径向渐变增加层次
- **粒子效果**：可选添加动态粒子背景增加科技感
- **光效**：重要数据周围可添加微弱发光效果

#### 数据可视化
- **实时数字**：重要数字滚动动画效果
- **K线图**：红绿配色符合中国股市习惯（红涨绿跌）
- **成交量**：柱状图使用半透明渐变
- **趋势线**：平滑曲线，支持多数据系列对比

### 可访问性要求
- **对比度**：所有文字与背景对比度达到WCAG AA标准
- **字体大小**：不小于12px，重要信息不小于14px
- **焦点状态**：键盘可访问，焦点明显可见
- **色盲友好**：不仅依赖颜色传达信息，配合图标或文字

## 4:技术选型
**框架**：Vue 3（Composition API, `<script setup>`）

**语言**：TypeScript（保证类型安全与长期可维护）

**构建**：Vite（开发快、配置直观）

**UI 组件库**：Ant Design Vue（企业级组件齐全、中文资料多）

**可视化**：ECharts（大屏/时序/地图/仪表盘都强）；

**HTTP 客户端**：Axios（拦截器、统一错误处理）

**路由**：Vue Router（分模块、权限守卫）

**国际化/本地化**：vue-i18n（中英文切换可选）

**打包与包管理**：pnpm（更快更省空间）

**质量与规范**：ESLint + Prettier + Husky + lint-staged

